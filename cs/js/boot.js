// Generated by CoffeeScript 1.7.1
$(function() {
  var app;
  window.app = app = new Backbone.Marionette.Application();
  app.addInitializer(function(options) {
    this.collections = {};
    this.collections = {
      desktops: new DesktopsCollection(data.desktops),
      notes: new NotesCollection(data.notes)
    };
    this.desktopSubset = new Backbone.CollectionSubset({
      parent: this.collections.notes,
      filter: function() {
        return true;
      }
    });
    this.currentDesktop = new DesktopModel;
    return this.stateCollections = {
      currentDesktopNotes: this.desktopSubset.child
    };
  });
  app.addInitializer(function(options) {
    var desktopsController;
    desktopsController = new DesktopsController({
      app: this,
      desktopSubset: this.desktopSubset,
      desktopCollection: this.collections.desktops,
      currentDesktopNotesCollection: this.stateCollections.currentDesktopNotes,
      notesCollection: this.collections.notes
    });
    new DesktopsRouter({
      controller: desktopsController
    });
    return Backbone.history.start();
  });
  app.addInitializer(function(options) {
    this.layout = new ApplicationLayout({
      el: 'body'
    });
    return this.layout.render();
  });
  app.addInitializer(function(options) {
    this.layout.desktopsMenu.show(new DesktopsMenuView({
      collection: this.collections.desktops,
      currentDesktop: this.currentDesktop
    }));
    this.layout.createNodeMenu.show(new CreateNoteView({
      notesCollection: this.collections.notes,
      app: this
    }));
    return this.layout.desktop.show(new DesktopView({
      collection: this.stateCollections.currentDesktopNotes
    }));
  });
  return app.start();
});
